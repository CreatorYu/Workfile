; Top Design: "man_lib:layout_sim_ BL_coupler _optimization:schematic"
; Netlisted using Hierarchy Policy: "Standard"

Options ResourceUsage=yes UseNutmegFormat=no EnableOptim=no TopDesignName="man_lib:layout_sim_ BL_coupler _optimization:schematic" DcopOutputNodeVoltages=yes DcopOutputPinCurrents=yes DcopOutputAllSweepPoints=no DcopOutputDcopType=0
; Library Name: man_lib
; Cell Name: layout_ BL_coupler _optimization
; View Name: emModel
define "layout_#20BL_coupler#20_optimization" ( P1  P2  P3  P4  Ref=0 ) 
parameters  l1=12.5631 mm  l2=11.6812 mm  w1=1.09813 mm  w2=1.86728 mm  w3=1.09813 mm 
; MomCmpt model has node 0 as implicit reference. Ref node will be ignored and assumed to be grounded!
em_data_name="man_lib:layout_ BL_coupler _optimization:emModel"
em_data_p0="l1"
em_data_v0=l1
em_data_p1="l2"
em_data_v1=l2
em_data_p2="w1"
em_data_v2=w1
em_data_p3="w2"
em_data_v3=w2
em_data_p4="w3"
em_data_v4=w3
MomCmpt:em_data  P1 P2 P3 P4 \
    name=em_data_name \
    paramFile="" \
    modelFile="C:/Users/abc/Desktop/workfile/ads/man_wrk/man_lib/layout_#20%B%L_coupler#20_optimization/em%Model/model.ndx" \
    p0="l1" v0=l1 v0_Resolution=0.001 mil \
    p1="l2" v1=l2 v1_Resolution=0.001 mil \
    p2="w1" v2=w1 v2_Resolution=0.001 mil \
    p3="w2" v3=w2 v3_Resolution=0.001 mil \
    p4="w3" v4=w3 v4_Resolution=0.001 mil \
    ModelReuse=1 \
    ModelType="MOMMW" \
    ExtrapolationMode="linear" \
    EnforcePassivity=-1
end "layout_#20BL_coupler#20_optimization"

Port:TermG1  N__15 0 Num=1 Z=50 Ohm Noise=yes 
Port:TermG2  N__12 0 Num=2 Z=50 Ohm Noise=yes 
Port:TermG3  N__6 0 Num=3 Z=50 Ohm Noise=yes 
Port:TermG4  N__14 0 Num=4 Z=50 Ohm Noise=yes 
model MSub1 MSUB H=0.508 mm Er=3.55 Mur=1 Cond=5.88e7 Hu=1e+33 mm T=0.035 mm TanD=0.0022 Rough=0 mil DielectricLossModel=1 FreqForEpsrTanD=1.0 GHz LowFreqForTanD=1.0 kHz HighFreqForTanD=1.0 THz RoughnessModel=2 
S_Param:SP1 CalcS=yes CalcY=no CalcZ=no GroupDelayAperture=1e-4 FreqConversion=no FreqConversionPort=1 StatusLevel=2 CalcNoise=no SortNoise=0 BandwidthForNoise=1.0 Hz DevOpPtLevel=0 \
SweepVar="freq" SweepPlan="SP1_stim" OutputPlan="SP1_Output" 

SweepPlan: SP1_stim Start=3.1 GHz Stop=3.9 GHz Step=0.001 GHz 

OutputPlan:SP1_Output \
      Type="Output" \
      UseEquationNestLevel=yes \
      EquationNestLevel=2 \
      UseSavedEquationNestLevel=yes \
      SavedEquationNestLevel=2

#load "python","LinearCollapse"
Component Module="LinearCollapse" Type="ModelExtractor" NetworkRepresentation=2

l1=12.5631 opt{ 5 to 20 }
l2=11.6812 opt{ 5 to 20 }
w1=1.098130
w2=1.867280
w3=1.098130

Optim:"Optim1" OptimType="hpVMO" ErrorForm="L2" MaxIters=100 P=2 DesiredError=0.0 StatusLevel=4 FinalAnalysis="None" NormalizeGoals=yes SetBestValues=yes SaveSolns=yes SaveGoals=yes SaveOptimVars=no UpdateDataset=yes SaveNominal=no SaveAllIterations=no UseAllOptVars=yes UseAllGoals=yes SaveCurrentEF=no InitialTempControlMode=0 NumShootsPerIter=20 EnableCockpit=yes NormalizeError=yes SaveAllTrials=no UseAdvTermCriteria=no CostRelativeTol=1.0e-8 LimitOfContSmallImprovement=5 

OptimGoal:OptimGoal1 Expr="dB(S(1,1))" SimInstanceName="SP1" Weight=1 \
IndepVar[1]="freq" \
SpecLimitLine[1]="OptimGoal1_limit1" 
SpecLimitLine:"OptimGoal1_limit1" Type="LessThan" Max=-20 Weight=1 \
IndepVar[1]="freq" IndepMin[1]=3.1e+09 IndepMax[1]=3.9e+09 
OptimGoal:OptimGoal2 Expr="dB(S(1,2))" SimInstanceName="SP1" Weight=1 \
IndepVar[1]="freq" \
SpecLimitLine[1]="OptimGoal2_limit1" 
SpecLimitLine:"OptimGoal2_limit1" Type="GreaterThan" Min=-3.25 Weight=1 \
IndepVar[1]="freq" IndepMin[1]=3.1e+09 IndepMax[1]=3.9e+09 
OptimGoal:OptimGoal3 Expr="dB(S(1,3))" SimInstanceName="SP1" Weight=1 \
IndepVar[1]="freq" \
SpecLimitLine[1]="OptimGoal3_limit1" 
SpecLimitLine:"OptimGoal3_limit1" Type="GreaterThan" Min=-3.25 Weight=1 \
IndepVar[1]="freq" IndepMin[1]=3.1e+09 IndepMax[1]=3.9e+09 
OptimGoal:OptimGoal4 Expr="dB(S(1,4))" SimInstanceName="SP1" Weight=1 \
IndepVar[1]="freq" \
SpecLimitLine[1]="OptimGoal4_limit1" 
SpecLimitLine:"OptimGoal4_limit1" Type="LessThan" Max=-20 Weight=1 \
IndepVar[1]="freq" IndepMin[1]=3.1e+09 IndepMax[1]=3.9e+09 
"layout_#20BL_coupler#20_optimization":X1  N__15 N__12 N__6 N__14 l1=12.5631 mm l2=11.6812 mm w1=1.09813 mm w2=1.86728 mm w3=1.09813 mm 
